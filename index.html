<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>å­¸ç”Ÿåˆ†çµ„ï¼ˆé˜²å‘†ç‰ˆï¼‰</title>
<style>
body {
  font-family: "Noto Sans TC", sans-serif;
  background: #f4f6f8;
  padding: 20px;
}

h1 {
  font-size: 28px;
}

textarea {
  width: 100%;
  height: 120px;
  font-size: 18px;
  margin-bottom: 10px;
}

button {
  font-size: 20px;
  padding: 10px 20px;
  cursor: pointer;
}

.group {
  background: white;
  border-radius: 10px;
  padding: 10px;
  margin-top: 15px;
  font-size: 22px;
}
</style>
</head>
<body>

<h1>ğŸ¯ å­¸ç”Ÿéš¨æ©Ÿåˆ†çµ„ï¼ˆå«é˜²å‘†ï¼‰</h1>

<h3>ğŸ“‹ å­¸ç”Ÿåå–®ï¼ˆæ¯è¡Œä¸€äººï¼‰</h3>
<textarea id="students">
ç‹å°æ˜
æå°è¯
é™³å¤§é›„
æ—å°ç¾
å¼µå°å¼·
é»ƒå°èŠ¬
å³å°å‚‘
é„­å°èŠ³
ä½•å°é¾
è”¡å°ç²
</textarea>

<h3>ğŸš« ä¸èƒ½åŒçµ„ï¼ˆæ¯è¡Œä¸€çµ„ï¼Œç”¨é€—è™Ÿåˆ†éš”ï¼‰</h3>
<textarea id="banRules">
ç‹å°æ˜,æå°è¯,é™³å¤§é›„
</textarea>

<button onclick="makeGroups()">ğŸ² ç”Ÿæˆåˆ†çµ„</button>

<div id="result"></div>

<script>
const GROUP_COUNT = 4;

// è§£æå­¸ç”Ÿ
function getStudents(){
  return document.getElementById("students")
    .value.split("\n")
    .map(s => s.trim())
    .filter(s => s);
}

// è§£æç¦æ­¢è¦å‰‡
function parseBans(){
  return document.getElementById("banRules")
    .value.split("\n")
    .map(line =>
      line.split(",").map(n => n.trim()).filter(n => n)
    )
    .filter(arr => arr.length > 0);
}

// ğŸ”´ é˜²å‘† 1ï¼šè¦å‰‡æœ¬èº«ä¸å¯èƒ½
function checkImpossibleRules(bans, groupCount){
  for(const rule of bans){
    if(rule.length > groupCount){
      return rule;
    }
  }
  return null;
}

function shuffle(arr){
  return arr.sort(() => Math.random() - 0.5);
}

function makeGroups(){
  const students = getStudents();
  const bans = parseBans();

  // ğŸš¨ é˜²å‘† 1ï¼ˆä¸€å®šè·³ alertï¼‰
  const impossible = checkImpossibleRules(bans, GROUP_COUNT);
  if(impossible){
    alert(
      "âŒ è¦å‰‡è¨­å®šä¸å¯èƒ½æˆç«‹\n\n" +
      "ä»¥ä¸‹å­¸ç”Ÿäººæ•¸ï¼ˆ" + impossible.length + " äººï¼‰\n" +
      "å¤§æ–¼ç›®å‰çµ„æ•¸ï¼ˆ" + GROUP_COUNT + " çµ„ï¼‰ï¼š\n\n" +
      impossible.join("ã€") +
      "\n\nè«‹èª¿æ•´ç¦æ­¢åŒçµ„åå–®æˆ–å¢åŠ çµ„æ•¸"
    );
    return;
  }

  // ä»¥ä¸‹åªæ˜¯ç°¡å–®ç¤ºç¯„åˆ†çµ„ï¼ˆé‡é»åœ¨é˜²å‘†ï¼‰
  const groups = Array.from({length: GROUP_COUNT}, () => []);
  shuffle(students).forEach((s, i) => {
    groups[i % GROUP_COUNT].push(s);
  });

  // é¡¯ç¤º
  const result = document.getElementById("result");
  result.innerHTML = "";
  groups.forEach((g, i) => {
    const div = document.createElement("div");
    div.className = "group";
    div.textContent = "ç¬¬ " + (i+1) + " çµ„ï¼š " + g.join("ã€");
    result.appendChild(div);
  });
}
</script>

</body>
</html>

